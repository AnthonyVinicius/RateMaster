import{_ as H,D as x,r as m,j as J,c as a,a as e,b as i,w as n,C as c,t as r,u as C,d,k as K,v as Q,n as W,e as _,p as N,q as B,h as X,o,g as Y,G as Z}from"./index-gYmHc71o.js";const ee={class:"text-white d-flex flex-row profile-background position-relative"},se={class:"ms-3"},te={class:"hstack gap-2"},le={key:0,class:"profile-text"},ae={key:2,class:"hstack gap-2"},oe={key:0,class:"bi bi-check-circle-fill"},ie={key:1,class:"bi bi-exclamation-triangle-fill"},ne={key:2,class:"bi bi-x-circle-fill"},re={key:1,class:"container-fluid pb-3 bg-white"},ce={class:"container-fluid d-flex"},de={class:"hstack gap-3 mt-5 me-auto"},ue={class:"hstack gap-1 ms-auto"},me={key:0,class:"container-fluid mt-5 mb-5 col-md-11"},ve={class:"row row-cols-1 row-cols-md-6 g-4"},pe={class:"card rounded-3 h-100 text-truncate"},_e=["onClick"],be={class:"d-flex justify-content-center align-items-center img-container"},fe=["src","alt"],he={class:"card-body"},ge={class:"hstack"},ye={class:"fw-bold text-truncate"},ke={class:"card-text text-truncate"},we={class:"card-text text-truncate"},xe={class:"price text-truncate"},Ce={class:"card-actions"},Ne={key:1,class:"mt-3 pt-5 text-body"},Te={class:"card-body p-4"},Pe={class:"table-responsive"},Me={class:"table table-striped table-bordered"},De={class:"d-flex justify-content-center align-items-center img-container-list"},Ue=["src","alt"],Ve={class:"card-text"},$e={class:"card-text"},Ae={class:"price"},Be={class:"card-text"},Ee={class:"card-text"},Se={__name:"MyProfileView",setup(je){const T=Y(),P=new x("products"),E=new x("brands"),S=new x("user"),j=new x("shop"),v=m([]),M=m({}),D=m(null),b=m("success"),g=m(!1),u=Z("userData"),y=m("columns"),p=m(!1),f=m(""),k=m(""),q=()=>{y.value="columns"},L=()=>{y.value="list"},z=()=>{p.value=!0},R=()=>{p.value=!1,f.value=null},U=(l,s="success")=>{D.value=l,b.value=s,g.value=!0,setTimeout(()=>g.value=!1,3e3)},I=async()=>{k.value=f.value.trim(),p.value=!1;try{u.value.userType==="individual"&&await S.update(u.value.id,{name:k.value}),u.value.userType==="business"&&await j.update(u.value.id,{name:k.value}),u.value.name=k.value,f.value=null}catch(l){console.error("Erro ao atualizar o nome:",l)}},F=async()=>{try{const l=await E.getAll();M.value=l.reduce((s,h)=>(s[h.id]=h.name,s),{})}catch(l){console.error("Erro ao carregar marcas:",l)}},G=async()=>{try{await F(),v.value=await P.search("idShop",u.value.id),v.value=v.value.map(l=>(l.brandName=M.value[l.brand]||"Sem Marca",l))}catch(l){console.log("erro filtrado",v.value),console.error("Erro ao carregar produtos:",l)}},V=async l=>{if(confirm("Tem certeza de que deseja remover este Produto?"))try{await P.delete(l),v.value=v.value.filter(s=>s.id!==l),U("Produto removido com sucesso!","success")}catch(s){console.error(s),U("Erro ao remover produto.","danger")}},$=l=>{T.push({name:"updateProducts",params:{id:l}})},O=l=>{T.push({name:"productDetail",params:{id:l}})};return J(()=>{G()}),(l,s)=>{var A;const h=X("RouterLink");return o(),a(N,null,[e("div",ee,[i(c,{class:"position-absolute top-0 end-0 m-3 me-4",onClick:z},{default:n(()=>s[2]||(s[2]=[e("i",{class:"bi bi-pencil-square"},null,-1)])),_:1}),s[5]||(s[5]=e("div",{class:"ms-5 mt-5 d-flex flex-column"},[e("img",{src:"https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-profiles/avatar-1.webp",alt:"Profile Logo",class:"img-fluid img-thumbnail mt-4 mb-2 rounded-pill profile-logo"})],-1)),e("div",se,[e("div",te,[p.value?d("",!0):(o(),a("h5",le,r(C(u).name),1)),p.value?K((o(),a("input",{key:1,"onUpdate:modelValue":s[0]||(s[0]=t=>f.value=t),type:"text",class:"form-control"},null,512)),[[Q,f.value]]):d("",!0),p.value?(o(),a("div",ae,[i(c,{class:"button me-1 form-control",onClick:I},{default:n(()=>s[3]||(s[3]=[_(" Salvar ")])),_:1}),i(c,{class:"button form-control",onClick:R},{default:n(()=>s[4]||(s[4]=[_(" Cancelar ")])),_:1})])):d("",!0)]),e("h5",null,r(C(u).email),1)])]),g.value?(o(),a("div",{key:0,class:W(`alert alert-${b.value} alert-dismissible fade show custom-alert m-3`),role:"alert"},[b.value==="success"?(o(),a("i",oe)):d("",!0),b.value==="warning"?(o(),a("i",ie)):d("",!0),b.value==="danger"?(o(),a("i",ne)):d("",!0),_(" "+r(D.value)+" ",1),e("button",{type:"button",class:"btn-close",onClick:s[1]||(s[1]=t=>g.value=!1)})],2)):d("",!0),((A=C(u))==null?void 0:A.userType)!=="individual"?(o(),a("div",re,[e("div",ce,[e("div",de,[i(h,{to:"/brand"},{default:n(()=>[i(c,null,{default:n(()=>s[6]||(s[6]=[e("i",{class:"bi bi-plus-circle"},null,-1),_(" Nova Marca")])),_:1})]),_:1}),i(h,{to:"/registerProduct"},{default:n(()=>[i(c,null,{default:n(()=>s[7]||(s[7]=[e("i",{class:"bi bi-box-seam"},null,-1),_(" Novo produto")])),_:1})]),_:1})]),e("div",ue,[i(c,{class:"mt-3",onClick:q},{default:n(()=>s[8]||(s[8]=[e("i",{class:"bi bi-layout-three-columns"},null,-1)])),_:1}),i(c,{class:"mt-3",onClick:L},{default:n(()=>s[9]||(s[9]=[e("i",{class:"bi bi-list-nested"},null,-1)])),_:1})])]),y.value==="columns"?(o(),a("div",me,[e("div",ve,[(o(!0),a(N,null,B(v.value,t=>(o(),a("div",{class:"product-card",key:t.id},[e("div",pe,[e("div",{class:"content-card",onClick:w=>O(t.id)},[e("div",be,[e("img",{class:"img-fluid product-img",src:t.image,alt:t.name},null,8,fe)]),e("div",he,[e("div",ge,[e("h4",ye,r(t.name),1)]),e("p",ke,[s[10]||(s[10]=_("Marca: ")),e("strong",null,r(t.brandName),1)]),e("p",we,r(t.description),1),e("p",xe,r(t.price),1)])],8,_e),e("div",Ce,[i(c,{onClick:w=>V(t.id),class:"action-button"},{default:n(()=>s[11]||(s[11]=[e("i",{class:"bi bi-trash-fill"},null,-1)])),_:2},1032,["onClick"]),i(c,{onClick:w=>$(t.id),class:"action-button"},{default:n(()=>s[12]||(s[12]=[e("i",{class:"bi bi-pencil-square"},null,-1)])),_:2},1032,["onClick"])])])]))),128))])])):d("",!0),y.value=="list"?(o(),a("div",Ne,[e("div",null,[e("div",Te,[e("div",Pe,[e("table",Me,[s[15]||(s[15]=e("thead",null,[e("tr",null,[e("th",{scope:"col"},"Imagem"),e("th",{scope:"col"},"Nome"),e("th",{scope:"col"},[e("span",{class:"m-3"},"Marca")]),e("th",{scope:"col"},"Preço"),e("th",{scope:"col"},"Tipo"),e("th",{scope:"col"},"Descrição"),e("th",{scope:"col"},"Ações")])],-1)),e("tbody",null,[(o(!0),a(N,null,B(v.value,t=>(o(),a("tr",{key:t.id},[e("td",null,[e("div",De,[e("img",{class:"img-fluid rounded-2 product-img-list",src:t.image,alt:t.name},null,8,Ue)])]),e("td",Ve,r(t.name),1),e("td",$e,r(t.brandName),1),e("td",Ae,r(t.price),1),e("td",Be,r(t.type),1),e("td",Ee,r(t.description),1),e("td",null,[i(c,{onClick:w=>V(t.id),type:"button",class:"ms-2 me-2"},{default:n(()=>s[13]||(s[13]=[e("i",{class:"bi bi-trash-fill"},null,-1)])),_:2},1032,["onClick"]),i(c,{onClick:w=>$(t.id),type:"button",class:"ms-2 me-2"},{default:n(()=>s[14]||(s[14]=[e("i",{class:"bi bi-pencil-square"},null,-1)])),_:2},1032,["onClick"])])]))),128))])])])])])])):d("",!0)])):d("",!0)],64)}}},Le=H(Se,[["__scopeId","data-v-3e9638cd"]]);export{Le as default};
